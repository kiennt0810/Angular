<div>
    <form name="editForm" (ngSubmit)="createDV()" action="" style="background-color: white;" [formGroup]="editForm">
        <div class="p-4">
            <div class="row" role="form">
                <div class="col-sm-3">
                    <h6>STT đoàn</h6>
                </div>
                <div class="col-sm-9">
                    <input #maDoan class="form-control" type="text" name="maDoan" formControlName="maDoan"
                        [attr.disabled]="disableTextbox? true : null" [attr.disabled]="true">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-3">
                    <h6>Tên đoàn <span class="text-danger">*</span></h6>
                </div>
                <div class="col-sm-9">
                    <input class="form-control" type="text" name="tenDoan" formControlName="tenDoan"
                        [attr.disabled]="disableTextbox? true : null">
                    <div *ngIf="editForm.get('tenDoan')!.invalid && editForm.get('tenDoan')!.touched">
                        <small class="form-text text-danger" *ngIf="editForm.get('tenDoan')?.errors?.required">
                            Trường này không được để trống.
                        </small>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-3">
                    <h6>Trưởng đoàn <span class="text-danger">*</span></h6>
                </div>
                <div class="col-sm-9">
                    <input class="form-control" type="text" name="truongDoan" formControlName="truongDoan"
                        [attr.disabled]="disableTextbox? true : null">
                    <div *ngIf="editForm.get('truongDoan')!.invalid && editForm.get('truongDoan')!.touched">
                        <small class="form-text text-danger" *ngIf="editForm.get('truongDoan')?.errors?.required">
                            Trường này không được để trống.
                        </small>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-3">
                    <h6>Chức vụ</h6>
                </div>
                <div class="col-sm-9">
                    <input class="form-control" type="text" name="chucVu" formControlName="chucVu"
                        [attr.disabled]="disableTextbox? true : null">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-3">
                    <h6>Mục đích hoạt động</h6>
                </div>
                <div class="col-sm-9">
                    <input class="form-control" type="text" name="mucDichHD" formControlName="mucDichHD"
                        [attr.disabled]="disableTextbox? true : null">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-3">
                    <h6>Ngày xuất cảnh <span class="text-danger">*</span></h6>
                </div>
                <div class="col-sm-3">
                    <div class="w-30">
                        <input class="form-control" type="text" placeholder="dd/mm/yyyy" id="ngayXC" bsDatepicker
                            [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="ngayXC"
                            formControlName="ngayXC" (change)="isInvalidDateNgayXC($event)"
                            (bsValueChange)="checkDateNgayXC($event)" maxlength="10" (keypress)=" numberOnlywithForwardSlash($event)"/>
                        <div *ngIf="editForm.get('ngayXC')!.invalid && editForm.get('ngayXC')!.touched">
                            <small class="form-text text-danger" *ngIf="editForm.get('ngayXC')?.errors?.required">
                                Trường này không được để trống.
                            </small>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <h6 style="padding-left: 10%;">Ngày nhập cảnh</h6>
                </div>
                <div class="col-sm-3">
                    <div class="w-30 input-group">
                        <input class="form-control" type="text" placeholder="dd/mm/yyyy" id="ngayNC" bsDatepicker
                            [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="ngayNC"
                            formControlName="ngayNC" (change)="isInvalidDateNgayNC($event)"
                            (bsValueChange)="checkDateNgayNC($event)" maxlength="10" (keypress)=" numberOnlywithForwardSlash($event)">
                        <!-- <span class="input-group-text" *ngIf="isShowSideBar">
                            <span class="bi bi-calendar" (click)="dp1.toggle()"></span>
                        </span> -->
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-3">
                    <h6>Số lượng thành viên trong đoàn</h6>
                </div>
                <div class="col-sm-3">
                    <input class="form-control" type="text" name="soLuongTV" formControlName="soLuongTV"
                        [attr.disabled]="disableTextbox? true : null" />
                </div>
                <div class="col-sm-6" style="align-self: center;">
                    <h6>&nbsp;người</h6>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-3">
                    <h6>Ghi chú</h6>
                </div>
                <div class="col-sm-9">
                    <input class="form-control" type="text" name="ghiChu" formControlName="ghiChu"
                        [attr.disabled]="disableTextbox? true : null">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-3">
                    <h6>Hồ sơ đính kèm</h6>
                </div>
                <div class="col-sm-9 custom-file-button">
                    <label for="uploadDocument">Tải tệp file không lớn hơn
                        <strong>100 MB</strong></label>
                    <mat-chip-list #chipList>
                        <input type="file" multiple #uploadFile (change)="handleFileInput($event)"
                            [matChipInputFor]="chipList" name="listFile" formControlName="listFile" id="inputGroupFile">
                        <label class="input-group-text label-cus mt-1" for="inputGroupFile">Tải tập tin</label>
                        <mat-chip style="background-color: #e3e5e6;"
                            *ngFor="let file of lstUploadedFiles; let index = index" [removable]="true"
                            (removed)="remove(file.AttachmentName, index)">
                            {{file.AttachmentName}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                    </mat-chip-list>
                </div>
            </div>
            <br>
            <div class="form-group row">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th class="text-center col-1">STT</th>
                            <th class="text-center col-10">Tên file</th>
                            <th class="text-center col-1">Thao tác</th>
                        </tr>
                    </thead>
                    <tbody formArrayName="listDRFileVM">
                        <tr *ngFor="let itemLD of listFileControls; let i = index" [formGroupName]="i">
                            <td class="text-center" style="font-weight: bold;"></td>
                            <td><input type="text" class="form-control" style="width: 100%;" name="fileName"
                                    formControlName="fileName" [attr.disabled]="true"></td>
                            <td class="text-center">
                                <a class="add" title="Add" data-toggle="tooltip"
                                    (click)="downloadFile(doanRa.listDRFileVM[i].id, doanRa.listDRFileVM[i].fileName)"><i
                                        class="material-icons">file_download</i></a>
                                <a class="delete" title="Delete" data-toggle="tooltip"
                                    (click)="deleteRowFile(i,doanRa.listDRFileVM[i].id)"><i
                                        class="material-icons">&#xE872;</i></a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br>
            <div class="form-group row">
                <h6>Lãnh đạo tiếp đoàn</h6>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th class="text-center col-1">STT</th>
                            <th class="text-center col-10">Họ và tên</th>
                            <th class="text-center col-1">Thao tác</th>
                        </tr>
                    </thead>
                    <tbody formArrayName="jsonLanhDao">
                        <tr *ngFor="let itemLD of lanhDaoControls; let i = index" [formGroupName]="i">
                            <td class="text-center" style="font-weight: bold;"></td>
                            <td><input type="text" class="form-control" style="width: 100%;" name="hoTen"
                                    formControlName="hoTen" [attr.disabled]="disableTextbox? true : null"></td>
                            <td style="display: none;"><input type="text" class="form-control" style="width: 100%;"
                                    name="iD" formControlName="iD" [ngModel]="0"></td>
                            <td class="text-center">
                                <a class="add" title="Add" data-toggle="tooltip" (click)="addTableLDTD()"><i
                                        class="material-icons">&#xE03B;</i></a>
                                <a class="delete" title="Delete" data-toggle="tooltip" (click)="deleteRowLDTD(i)"><i
                                        class="material-icons">&#xE872;</i></a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br>
            <div class="form-group row">
                <h6>Quốc gia đến</h6>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th class="text-center col-1" style="vertical-align: middle;">STT</th>
                            <th class="text-center col-2" style="vertical-align: middle;">Quốc gia</th>
                            <th class="text-center col-3" style="vertical-align: middle;">Chương trình hoạt động</th>
                            <th class="text-center col-1" style="vertical-align: middle;">Số lượng thành viên</th>
                            <th class="text-center col-3" style="vertical-align: middle;">Nơi lưu trú</th>
                            <th class="text-center col-1" style="vertical-align: middle;">Số ngày lưu trú</th>
                            <th class="text-center col-1" style="vertical-align: middle;">Thao tác</th>
                        </tr>
                    </thead>
                    <tbody formArrayName="jsonHoSoDtl">
                        <tr *ngFor="let itemDP of qGiaDenControls; let i = index" [formGroupName]="i">
                            <td class="text-center" style="font-weight: bold;"></td>
                            <td>
                                <select style="background-color: white;" class="form-select" name="maQG"
                                    formControlName="maQG" id="quocGia" [attr.disabled]="disableTextbox? true : null">
                                    <option value=null default>-------Chọn quốc gia-------</option>
                                    <option *ngFor="let item of quocGiaList" [value]="item.maQG">{{ item.ten }}</option>
                                </select>
                            </td>
                            <td><input type="text" class="form-control" style="width: 100%;" name="chuongTrinhHD"
                                    formControlName="chuongTrinhHD" [attr.disabled]="disableTextbox? true : null"></td>
                            <td><input type="text" class="form-control" style="width: 100%;" name="soLuongTV"
                                    formControlName="soLuongTV" [attr.disabled]="disableTextbox? true : null"></td>
                            <td><input type="text" class="form-control" style="width: 100%;" name="noiLuuTru"
                                    formControlName="noiLuuTru" [attr.disabled]="disableTextbox? true : null"></td>
                            <td><input type="text" class="form-control" style="width: 100%;" name="soNgayLuuTru"
                                    formControlName="soNgayLuuTru" [attr.disabled]="disableTextbox? true : null"></td>
                            <td style="display: none;"><input type="text" class="form-control" style="width: 100%;"
                                    name="iD" formControlName="iD" [ngModel]="0"></td>
                            <td class="text-center">
                                <a class="add" title="Add" data-toggle="tooltip" (click)="addTableHDTCDP()"><i
                                        class="material-icons">&#xE03B;</i></a>
                                <a class="delete" title="Delete" data-toggle="tooltip" (click)="deleteRowHDTCDP(i)"><i
                                        class="material-icons">&#xE872;</i></a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="d-flex justify-content-end">
                <button class="btn btn-primary jh-create-entity buttonborder" data-cy="submit" style="margin-right: 1%;"
                    [disabled]="editForm.invalid">
                    <fa-icon class="bi bi-floppy-fill iconColor"></fa-icon>
                    <span class="iconColor">Cập nhật</span>
                </button>

                <button class="btn btn-primary jh-create-entity buttonborder" routerLink="/doanRa/quanLyDoanRa">
                    <fa-icon class="bi bi-box-arrow-left iconColor"></fa-icon>
                    <span class="iconColor">Quay lại</span>
                </button>
            </div>
        </div>
    </form>
</div>

<app-alert></app-alert>