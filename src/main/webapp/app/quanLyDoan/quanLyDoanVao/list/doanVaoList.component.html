<div>
  <div style="background-color: white; padding: 26px;">
    <h3 class="title" style="margin: 0;"><fa-icon class="bi bi-search" style="margin-left: 0;"></fa-icon><b>Điều kiện tìm kiếm</b></h3>
    <hr>
    <div>
      <form action="">
        <table style="height: 145px;">
          <tr>
            <td style="display: none;"></td>
            <td style="width: 9%;" class="text-nowrap">
              <h6>STT đoàn</h6>
            </td>
            <td><input class="form-control inputBorder" type="text" [(ngModel)]="fields.maDoan" name="maDoan" [ngModelOptions]="{standalone: true}"></td>
            <td style="padding-left: 4%;" class="text-nowrap">
              <h6>Mục đích hoạt động</h6>
            </td>
            <td><input class="form-control inputBorder" type="text" [(ngModel)]="fields.mucDichHD" name="mucDichHD" [ngModelOptions]="{standalone: true}">
            </td>
            <td style="padding-left: 3%;" class="text-nowrap">
              <h6>Ngày nhập cảnh</h6>
            </td>
            <td><input class="form-control inputBorder" type="text" placeholder="dd/mm/yyyy" bsDatepicker
                [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY', showWeekNumbers: false }" [(ngModel)]="fields.ngayNC"
                name="ngayNC" id="ngayNC" [ngModelOptions]="{standalone: true}" (change)="isInvalidDateNgayNC($event)"
                (keypress)=" numberOnlywithForwardSlash($event)" maxlength="10"/></td>
          </tr>
          <tr>
            <td style="display: none;"></td>
            <td class="text-nowrap">
              <h6>Tên đoàn</h6>
            </td>
            <td><input class="form-control inputBorder" type="text" [(ngModel)]="fields.tenDoan" name="tenDoan" [ngModelOptions]="{standalone: true}"></td>
            <td style="padding-left: 4%;" class="text-nowrap">
              <h6>Quốc gia</h6>
            </td>
            <td>
              <select class="form-select inputBorder" style="background-color: #fff" [(ngModel)]="fields.maQG" [ngModelOptions]="{standalone: true}" (change)="handleChange($event)" maxlength="10">
                <option [value]="null" default>------- Tất cả --------</option>
                <option *ngFor="let item of quocGiaList" [value]="item.maQG">{{ item.ten }}</option>
              </select>
            </td>
            <td style="padding-left: 3%;" class="text-nowrap">
              <h6>Ngày xuất cảnh</h6>
            </td>
            <td><input class="form-control inputBorder" type="text" placeholder="dd/mm/yyyy" bsDatepicker
                [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" [(ngModel)]="fields.ngayXC"
                name="ngayXC" id="ngayXC" [ngModelOptions]="{standalone: true}" (change)="isInvalidDateNgayXC($event)" 
                (keypress)=" numberOnlywithForwardSlash($event)" maxlength="10"/>
            </td>
          </tr>
          <tr>
            <td style="display: none;"></td>
            <td class="text-nowrap">
              <h6>Trưởng đoàn</h6>
            </td>
            <td><input class="form-control inputBorder" type="text" [(ngModel)]="fields.truongDoan" name="truongDoan" [ngModelOptions]="{standalone: true}">
            </td>
            <td style="padding-left: 4%;" class="text-nowrap">
              <h6 class="text-nowrap">Năm</h6>
            </td>
            <td><input class="form-control inputBorder" type="text" [(ngModel)]="fields.nam" name="nam" [ngModelOptions]="{standalone: true}"></td>
            <td></td>
            <td></td>
          </tr>
        </table>
      </form>
    </div>
    <br>
    <div class="d-flex justify-content-end">
      <button type="button" class="btn btn-primary jh-create-entity me-3 iconBG buttonborder" (click)="search()">
        <fa-icon class="iconColor" icon="search"></fa-icon>
        <span class="iconColor">Tìm kiếm</span>
      </button>
      <button type="button" *ngIf="checkAuth" class="btn btn-primary jh-create-entity me-3 iconBG buttonborder" [routerLink]="['./new']">
        <fa-icon class="iconColor" icon="plus"></fa-icon> <span class="iconColor">Thêm mới</span>
      </button>
      <button type="button" class="btn btn-primary jh-create-entity me-3 iconBG buttonborder" (click)="loadDataPrint()">
        <fa-icon class="bi-printer iconColor"></fa-icon> <span class="iconColor">In báo cáo</span>
      </button>
      <button type="button" class="btn btn-primary jh-create-entity me-3 iconBG buttonborder" (click)="loadDataExport()">
        <fa-icon class="bi-file-earmark-arrow-down iconColor"></fa-icon> <span class="iconColor">Kết xuất</span>
      </button>
      <button type="button" class="btn btn-primary jh-create-entity me-3 iconBG buttonborder" (click)="resetFields()">
        <fa-icon class="bi-trash iconColor"></fa-icon> <span class="iconColor">Xóa tìm kiếm</span>
      </button>
      <button type="button" class="btn btn-primary jh-create-entity me-3 iconBG buttonborder" routerLink="">
        <fa-icon class="bi-box-arrow-left iconColor"></fa-icon> <span class="iconColor">Thoát</span>
      </button>
    </div>
  </div>
  <div style="background-color: white; padding: 1%; margin-top: 1%;">
    <h3 class="title"><fa-icon class="bi bi-folder2"></fa-icon><b>Kết quả tìm kiếm</b></h3>
    <hr>
    <jhi-alert-error></jhi-alert-error>

    <jhi-alert></jhi-alert>

    <div class="table-responsive content-wrapper" *ngIf="users">
      <table class="table table-bordered table-striped" style="border: rgb(199, 199, 199) 1px;" id="table-data">
        <thead>
          <tr jhiSort [(predicate)]="predicate" [(ascending)]="ascending" (sortChange)="transition()">
            <th scope="col" class="text-center text-nowrap"><span>STT</span></th>
            <th scope="col" class="text-center text-nowrap"><span>STT đoàn</span></th>
            <th scope="col" class="text-center text-nowrap"><span>Tên đoàn</span></th>
            <th scope="col" class="text-center text-nowrap"><span>Trưởng đoàn</span></th>
            <th scope="col" class="text-center text-nowrap">
              <span>Quốc gia</span>
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Mục đích hoạt động</span>
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Ngày nhập cảnh</span>
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Ngày xuất cảnh</span>
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Số lượng thành viên</span>
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Người tạo</span>
            </th>
            <th scope="col" class="text-center text-nowrap"><span>Thao tác</span></th>
          </tr>
        </thead>
        <tbody *ngIf="ExPrItem">
                    <tr *ngFor="let user of ExPrItem | slice: (page-1) * itemsPerPage : (page-1) * itemsPerPage + itemsPerPage | myFilter :filter ; let i = index">
            <td class="text-center vertical">{{ExPrItem.indexOf(user)+1}}</td>
            <td class="text-center vertical">{{ user.maDoan }}</td>
            <td class="vertical">{{ user.tenDoan }}</td>
            <td class="vertical">{{ user.truongDoan }}</td>
            <td class="vertical">{{ user.quocGia }}</td>
            <td class="vertical">{{ user.mucDichHD }}</td>
            <td class="text-center vertical">{{ user.ngayNC}}</td>
            <td class="text-center vertical">{{ user.ngayXC}}</td>
            <td class="text-center vertical">
              <a class="color-0000a6 text-decoration-none" (click)="PopUp($event, popupDiv,user.maDoan)">{{ user.soLuongTV }}</a>
            </td>
            <td class="vertical">{{ user.createdBy }}</td>
            <td class="colButton text-center" style="vertical-align: middle;">
              <div class="text-nowrap">
                <button *ngIf="checkAuth" type="button" class="download" (click)="onSelectDoan(user)">
                  <i class="material-icons add">add_circle</i>
                </button>
                <button type="button" class="download" (click)="downloadFileAll(user.maDoan, user.tenDoan)">
                  <i class="material-icons download">file_download</i>
                </button>
                <button type="button" class="view" [routerLink]="['./viewDV', user.maDoan]">
                  <i class="material-icons view">visibility</i>
                </button>
                <button *ngIf="checkAuth" type="button" class="edit" (click)="editUser(user)" queryParamsHandling="merge">
                  <i class="material-icons edit">edit</i>
                </button>
                <button *ngIf="checkAuth" type="button" class="delete" (click)="deleteUser(user)">
                  <i class="material-icons delete">delete</i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="mt-2 divBGColor" *ngIf="ExPrItem?.length <= 0">
      <br><br><br>
      <div class="text-center">
          <h5 style="font-weight: bold;">Không tìm thấy bản ghi thỏa mãn điều kiện!</h5>
      </div>
      <br><br><br>
    </div>
    <div *ngIf="ExPrItem?.length > 0">
      <div class="row me-2 ms-2 pt-1">
        <div class="col-4 pt-2">
          <h6><i><jhi-item-count [params]="{ nameModule: 'đoàn vào', totalItems: totalItems }"></jhi-item-count></i>
          </h6>
        </div>
        <div class="col-4 d-flex justify-content-center">
          <ngb-pagination 
            [collectionSize]="totalItems" 
            [(page)]="page" 
            [pageSize]="itemsPerPage" 
            [maxSize]="5"
            [rotate]="true" 
            [boundaryLinks]="true" 
            (pageChange)="transition()">
          </ngb-pagination>
        </div>
        <div class="col-4 d-flex justify-content-end pt-2">
          <h6><i>Trang {{page}} / {{totalPage}}</i></h6>
        </div>
      </div>
    </div>

    
  </div>
</div>


<div class="popup"  role="alert" #popupDiv>
  <div class="popup-container">
    <a class="popup-close img-replace" (click)="PopUpClose($event, popupDiv)">Close</a>
    <div><h5>Danh sách thành viên đoàn</h5></div>
    <div class="table-responsive content-wrapper overflow-auto" *ngIf="qlyTV">
      <table class="table table-bordered table-striped" style="border: rgb(199, 199, 199) 1px;" id="table-data">
        <thead>
          <tr jhiSort [(predicate)]="predicate" [(ascending)]="ascending">
            <th scope="col" jhiSortBy="id" class="text-center"><span>STT</span></th>
            <th scope="col" jhiSortBy="login" class="text-center text-nowrap"><span>STT trong đoàn</span></th>
            <th scope="col" jhiSortBy="email" class="text-center text-nowrap"><span>Họ và tên</span></th>
            <th scope="col" class="text-center text-nowrap"><span>Chức vụ</span></th>
            <th scope="col" class="text-center text-nowrap">
              <span>Cơ quan làm việc</span> 
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Ngày sinh</span> 
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Giới tính</span> 
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Số hộ chiếu</span> 
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Ngày cấp</span> 
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Quốc gia</span> 
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Là thành viên của đoàn</span>
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Ngày nhập cảnh</span>
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Ngày xuất cảnh</span>
            </th>
            <th scope="col" class="text-center text-nowrap">
              <span>Nơi lưu trú</span>
            </th>
          </tr>
        </thead>
        <tbody *ngIf="qlyTV">
          <tr
            *ngFor="let user of qlyTV">
            <td class="text-center">{{qlyTV.indexOf(user)+1}}</td>
            <td class="text-center">{{ user.soTT }}</td>
            <td>{{ user.hoTen }}</td>
            <td>{{ user.chucVu }}</td>
            <td>{{ user.coQuan }}</td>
            <td class="text-center">{{ user.ngaySinh}}</td>
            <td class="text-center"><div *ngIf="user.gioiTinh === true">Nam</div>
                <div *ngIf="user.gioiTinh === false">Nữ</div></td>
            <td class="text-center">{{ user.soHoChieu }}</td>
            <td class="text-center">{{ user.hC_NgayCap }}</td>
            <td>{{ user.quocGia }}</td>
            <td>{{ user.tenHSDoan }}</td>
            <td class="text-center">{{ user.ngayNC }}</td>
            <td class="text-center">{{ user.ngayXC }}</td>
            <td>{{ user.noiLuuTru }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<app-alert></app-alert>