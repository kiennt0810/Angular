<div style="margin-bottom: 1%;">
    <form name="createForm" (ngSubmit)="kiemTra()" action="" style="background-color: white;" [formGroup]="createForm">
        <div class="row me-3 ms-3" role="form">
            <div class="col-sm-2 align-self-center">
                <h6 class="m-2">Số hộ chiếu <span class="text-danger">*</span></h6>
            </div>
            <div class="col-sm-8" style="padding-left: 2%;">
                <input class="form-control m-2" type="text" name="soHoChieuKT" formControlName="soHoChieuKT">
                <div *ngIf="createForm.get('soHoChieuKT')!.invalid && createForm.get('soHoChieuKT')!.touched">
                    <small class="form-text text-danger" *ngIf="createForm.get('soHoChieuKT')?.errors?.required">
                        Trường này không được để trống.
                    </small>
                </div>
            </div>
            <div class="col-sm-2 align-self-center" style="text-align: center;">
                <button class="btn btn-primary jh-create-entity"
                    style="width: 70%; color: white; background-color: #1A4792;">
                    <span>Kiểm tra</span>
                </button>
            </div>
        </div>
    </form>
</div>
<form name="createForm" (ngSubmit)="themTV()" action="" style="background-color: white;" [formGroup]="createForm">
    <!-- <h4 style="background-color: #1A4792; color: white;"><b>Thêm mới hồ sơ đoàn vào</b></h4> -->
    <div class="row me-3 ms-3">
        <div class="col-sm-9 custom-wrapper">
            <div class="row" role="form">
                <div class="col-sm-3">
                    <h6 class="m-2">STT trong đoàn</h6>
                </div>
                <div class="col-sm-9">
                    <input class="form-control" type="text" name="soTT" formControlName="soTT" [(ngModel)]="stt" (keypress)=" numberOnlywithForwardSlash($event)">
                </div>
            </div>
            <br>
            <div class="row" role="form">
                <div class="col-sm-3">
                    <h6 class="m-2">Họ tên</h6>
                </div>
                <div class="col-sm-9">
                    <input class="form-control" type="text" name="hoTen" formControlName="hoTen" [attr.disabled]="true">
                    <div *ngIf="createForm.get('hoTen')!.invalid && createForm.get('hoTen')!.touched">
                        <small class="form-text text-danger" *ngIf="createForm.get('hoTen')?.errors?.required">
                            Trường này không được để trống.
                        </small>
                    </div>
                </div>
            </div>
            <br>
            <div class="row" role="form">
                <div class="col-sm-3">
                    <h6 class="m-2">Giới tính</h6>
                </div>
                <div class="col-sm-3">
                    <select class="form-control" formControlName="gioiTinh" name="gioiTinh" #gioiTinh
                        (change)="onSelected()" [attr.disabled]="true">
                        <option value="" default>-------Chọn giới tính-------</option>
                        <option value="1">Nam</option>
                        <option value="0">Nữ</option>
                    </select>
                </div>
                <div class="col-sm-2">
                    <h6 class="m-2">Ngày sinh</h6>
                </div>
                <div class="col-sm-4">
                    <div class="w-30 input-group">
                        <input class="form-control" id="ngaySinh" type="text" placeholder="dd/mm/yyyy" bsDatepicker
                            [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="ngaySinh"
                            formControlName="ngaySinh" [attr.disabled]="true" />
                    </div>
                </div>
            </div>
            <br>
            <div class="row" role="form">
                <div class="col-sm-3">
                    <h6 class="m-2">Chức vụ</h6>
                </div>
                <div class="col-sm-9">
                    <input class="form-control" type="text" name="chucVu" formControlName="chucVu"
                        [attr.disabled]="true">
                </div>
            </div>
        </div>
        <br>
        <div class="col-2" style="margin-top: 1%; margin-left: 2%;">
            <div class="d-flex justify-content-center"
                style="background-color: white; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">
                <img *ngIf="imageUrlHC != null" [src]=imageUrlHC title="Tải ảnh"
                    style="max-width: 100%; height: 223px; cursor: pointer;">
                <img *ngIf="imageUrlHC == null" style="max-width: 100%; height: 223px;">
            </div>
            <div *ngIf="imageUrlHC != null" class="d-flex justify-content-center">
                <button type="button" class="btn w-100" style="background-color: #70B603; color: white;"
                    (click)="downloadFile(idAnh, 'AnhHC.jpg')">
                    Tải tệp tin
                </button>
            </div>

        </div>
        <br>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Cơ quan làm việc</h6>
        </div>
        <div class="col-sm-10">
            <input class="form-control" type="text" name="coQuan" formControlName="coQuan" [attr.disabled]="true">
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Số hộ chiếu</h6>
        </div>
        <div class="col-sm-2" style="padding-left: 3%;">
            <input class="form-control" type="text" name="soHoChieu" formControlName="soHoChieu" [attr.disabled]="true">
        </div>
        <div class="col-sm-2" style="padding-left: 5%;">
            <h6 class="m-2">Ngày cấp</h6>
        </div>
        <div class="col-sm-2">
            <div class=" input-group">
                <input class="form-control" type="text" placeholder="dd/mm/yyyy" bsDatepicker
                    [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" placeholder="dd/mm/yyyy"
                    name="hC_NgayCap" formControlName="hC_NgayCap" id="hC_NgayCap" [attr.disabled]="true"
                    (keypress)=" numberOnlywithForwardSlash($event)" />
                <div *ngIf="createForm.get('hC_NgayCap')!.invalid && createForm.get('hC_NgayCap')!.touched">
                    <small class="form-text text-danger" *ngIf="createForm.get('hC_NgayCap')?.errors?.required">
                        Trường này không được để trống.
                    </small>
                </div>
            </div>
        </div>
        <div class="col-sm-2" style="padding-left: 5%;">
            <h6 class="m-2">Ngày hết hạn</h6>
        </div>
        <div class="col-sm-2" style="padding-right: 3%;">
            <div class="w-30 input-group">
                <input class="form-control" type="text" placeholder="dd/mm/yyyy" bsDatepicker
                    [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="hC_NgayHL"
                    formControlName="hC_NgayHL" id="hC_NgayHL" [attr.disabled]="true"
                    (keypress)=" numberOnlywithForwardSlash($event)" />
                <div *ngIf="createForm.get('hC_NgayHL')!.invalid && createForm.get('hC_NgayHL')!.touched">
                    <small class="form-text text-danger" *ngIf="createForm.get('hC_NgayHL')?.errors?.required">
                        Trường này không được để trống.
                    </small>
                </div>
            </div>
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Loại hộ chiếu</h6>
        </div>
        <div class="col-sm-2" style="padding-left: 3%;">
            <!-- <select class="form-select" style="background-color: #fff;" name="hC_Loai" formControlName="hC_Loai" id="hC_Loai" [attr.disabled]="true">
                <option value=null default >-------Chọn loại hộ chiếu-------</option>
                <option *ngFor="let item of passports" [value]="item.id">{{ item.loaiHoChieu }}</option>
              </select> -->
            <input class="form-control" type="text" name="hC_Loai" formControlName="hC_Loai" [attr.disabled]="true">
            <div *ngIf="createForm.get('hC_Loai')!.invalid && createForm.get('hC_Loai')!.touched">
                <small class="form-text text-danger" *ngIf="createForm.get('hC_Loai')?.errors?.required">
                    Trường này không được để trống.
                </small>
            </div>
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Số thị thực <span class="text-danger">*</span></h6>
        </div>
        <div class="col-sm-2" style="padding-left: 3%;">
            <input class="form-control" type="text" name="hC_SoThiThuc" formControlName="hC_SoThiThuc">
            <div *ngIf="createForm.get('hC_SoThiThuc')!.invalid && createForm.get('hC_SoThiThuc')!.touched">
                <small class="form-text text-danger" *ngIf="createForm.get('hC_SoThiThuc')?.errors?.required">
                    Trường này không được để trống.
                </small>
            </div>
        </div>
        <div class="col-sm-2">
        </div>
        <div class="col-sm-2">
        </div>
        <div class="col-sm-2">
            <h6 class="m-2" style="padding-left: 16%;">Ngày cấp thị thực <span class="text-danger">*</span></h6>
        </div>
        <div class="col-sm-2" style="padding-right: 3%;">
            <div class="w-30 input-group">
                <input class="form-control" type="text" placeholder="dd/mm/yyyy" bsDatepicker
                    [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="hC_NgayCapTT"
                    formControlName="hC_NgayCapTT" id="hC_NgayCapTT" (change)="isInvalidDateNgayCapTT($event)"
                    (bsValueChange)="checkDateNgayCapTT($event)" (keypress)=" numberOnlywithForwardSlash($event)"
                    maxlength="10" />
                <div *ngIf="createForm.get('hC_NgayCapTT')!.invalid && createForm.get('hC_NgayCapTT')!.touched">
                    <small class="form-text text-danger" *ngIf="createForm.get('hC_NgayCapTT')?.errors?.required">
                        Trường này không được để trống.
                    </small>
                </div>
            </div>
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Quốc gia đến</h6>
        </div>
        <div class="col-sm-10">
            <select class="form-select" (change)="handleChange($event)" style="background-color: #fff;" name="quocGia"
                formControlName="maQG" id="quocGia">
                <option value=null default>-------Chọn quốc gia đến-------</option>
                <option *ngFor="let item of qGiaDen" [value]="item.maQG">{{ item.quocGia }}</option>
            </select>
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Nơi lưu trú</h6>
        </div>
        <div class="col-sm-10">
            <input class="form-control" type="text" name="noiLuuTru" formControlName="noiLuuTru">
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2">
            <h6 class="m-2">Ngày xuất cảnh</h6>
        </div>
        <div class="col-sm-2" style="padding-left: 3%;">
            <div class="w-30 input-group">
                <input class="form-control" type="text" placeholder="dd/mm/yyyy" bsDatepicker
                    [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="ngayXC"
                    formControlName="ngayXC" id="ngayXC" (bsValueChange)="isInvalidDateNgayXC($event)"
                    (change)="checkDateNgayXC($event)" (keypress)=" numberOnlywithForwardSlash($event)"
                    maxlength="10" />
            </div>
        </div>
        <div class="col-sm-2">
        </div>
        <div class="col-sm-2">
        </div>
        <div class="col-sm-2 pl-2">
            <h6 class="m-2" style="padding-left: 16%;">Ngày nhập cảnh</h6>
        </div>
        <div class="col-sm-2" style="padding-right: 3%;">
            <div class="w-30 input-group">
                <input class="form-control" type="text" placeholder="dd/mm/yyyy" bsDatepicker
                    [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="ngayNC"
                    formControlName="ngayNC" id="ngayNC" (bsValueChange)="isInvalidDateNgayNC($event)"
                    (change)="checkDateNgayNC($event)" (keypress)=" numberOnlywithForwardSlash($event)"
                    maxlength="10" />
            </div>
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Tặng phẩm</h6>
        </div>
        <div class="col-sm-10">
            <input class="form-control" type="text" name="tangPham" formControlName="tangPham">
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Hồ sơ đính kèm</h6>
        </div>
        <div class="col-sm-10 custom-file-button">
            <label for="uploadDocument">Tải tệp file không lớn hơn
                <strong>100 MB</strong></label>
            <mat-chip-list #chipList>
                <input type="file" multiple #uploadFile (change)="handleFileInput($event)" [matChipInputFor]="chipList"
                    name="listFile" formControlName="listFile" id="inputGroupFile">
                <label class="input-group-text label-cus mt-1" for="inputGroupFile">Tải tập tin</label>
                <mat-chip style="background-color: #e3e5e6;" *ngFor="let file of lstUploadedFiles; let index = index"
                    [removable]="true" (removed)="remove(file.AttachmentName, index)">
                    {{file.AttachmentName}}
                    <mat-icon matChipRemove>cancel</mat-icon>
                </mat-chip>
            </mat-chip-list>
        </div>
    </div>
    <br>
    <div class="row me-3 ms-3">
        <div class="col-sm-2 pl-2">
            <h6 class="m-2">Là thành viên của đoàn</h6>
        </div>
    </div>
    <div class="form-group row me-3 ms-3">
        <div class="col-sm-12" style="padding: 0% 2% 0% 2%;">
            <table class="table table-bordered">
                <thead>
                    <tr class="align-middle">
                        <th class="text-center" style="width: 4%;">STT</th>
                        <th class="text-center">STT đoàn</th>
                        <th class="text-center">Tên đoàn</th>
                        <!-- <th class="text-center">Quốc gia</th> -->
                        <th class="text-center">Ngày xuất cảnh</th>
                        <th class="text-center">Ngày nhập cảnh</th>
                        <th class="text-center">Số lượng thành viên</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="text-center"></td>
                        <td><input type="text" class="form-control" [(ngModel)]="doanRa.maDoan" name="maHSDoan"
                                formControlName="maHSDoan" [attr.disabled]="true"></td>
                        <td><input type="text" class="form-control" [(ngModel)]="doanRa.tenDoan" name="tenHSDoan"
                                formControlName="tenHSDoan" [attr.disabled]="true"></td>
                        <td><input type="text" class="form-control" [(ngModel)]="doanRa.ngayXC"
                                [ngModelOptions]="{standalone: true}" bsDatepicker
                                [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }"
                                [attr.disabled]="true"></td>
                        <!-- <td><input type="text" class="form-control" [(ngModel)]="qGiaDenDoan" [ngModelOptions]="{standalone: true}"></td> -->
                        <td><input type="text" class="form-control" [(ngModel)]="doanRa.ngayNC"
                                [ngModelOptions]="{standalone: true}" bsDatepicker
                                [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }"
                                [attr.disabled]="true"></td>

                        <td><input type="text" class="form-control" [(ngModel)]="doanRa.soLuongTV"
                                [ngModelOptions]="{standalone: true}" [attr.disabled]="true"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="row text-end p-3 me-3 ms-3">
        <div class="col-sm-12">
            <button class="btn btn-primary jh-create-entity buttonborder" data-cy="submit" style="margin-left: 2%;"
                [disabled]="createForm.invalid">
                <span class="iconColor">Thêm mới</span>
            </button>
        </div>
    </div>
</form>
<div class="mt-2">
    <form name="createForm" action="" style="background-color: white;" [formGroup]="createForm">
        <div class="row me-3 ms-3">
            <div class="col-sm-3 pl-2">
                <h6 class="m-2">Danh sách thành viên đoàn</h6>
            </div>
            <div class="col-sm-12" style="padding: 0% 2% 0% 2%; overflow-x: scroll;">
                <table class="table table-bordered" style="width: 200%;">
                    <thead>
                        <tr class="align-middle">
                            <th style="width: 2%;" class="text-center">STT</th>
                            <th class="text-center">STT trong đoàn</th>
                            <th class="text-center">Họ và tên</th>
                            <th class="text-center">Chức vụ</th>
                            <th class="text-center">Cơ quan làm việc</th>
                            <th class="text-center">Ngày sinh</th>
                            <th class="text-center">Giới tính</th>
                            <th class="text-center">Số hộ chiếu</th>
                            <th class="text-center">Ngày cấp</th>
                            <th class="text-center">Quốc gia đến</th>
                            <th class="text-center">Là thành viên của đoàn</th>
                            <th class="text-center">Ngày xuất cảnh</th>
                            <th class="text-center">Ngày nhập cảnh</th>
                            <th class="text-center">Nơi lưu trú</th>
                            <th class="text-center">Thao tác</th>
                        </tr>
                    </thead>
                    <tbody formArrayName="dSThanhVienDoan">
                        <tr *ngFor="let itemDP of dSThanhVienDoanControls; let i = index" [formGroupName]="i">
                            <td class="text-center">{{i+1}}</td>
                            <td><input type="text" class="form-control" name="soTT" formControlName="soTT" [attr.disabled]="true" ></td>
                            <td><input type="text" class="form-control" name="hoTenTT" formControlName="hoTen"
                                    [attr.disabled]="true"></td>
                            <td><input type="text" class="form-control" name="chucVu" formControlName="chucVu"
                                    [attr.disabled]="true"></td>
                            <td><input type="text" class="form-control" name="coQuan" formControlName="coQuan"
                                    [attr.disabled]="true"></td>
                            <td><input type="text" class="form-control" name="ngaySinh" formControlName="ngaySinh"
                                    [attr.disabled]="true"></td>
                            <td><input type="text" class="form-control" name="gioiTinh" formControlName="gioiTinh"
                                    [attr.disabled]="true"></td>
                            <td><input type="text" class="form-control" name="soHoChieu" formControlName="soHoChieu"
                                    [attr.disabled]="true">
                            </td>
                            <td><input type="text" class="form-control" name="hC_NgayCap" formControlName="hC_NgayCap"
                                    [attr.disabled]="true">
                            </td>
                            <td>
                                <select class="form-select" (change)="handleChange($event)" name="quocGia"
                                    formControlName="maQG" id="quocGia" [attr.disabled]="true">
                                    <option value=null default></option>
                                    <option *ngFor="let item of qGiaDen" [value]="item.maQG">{{ item.quocGia }}</option>
                                </select>
                            </td>
                            <td><input type="text" class="form-control" name="tenHSDoan" formControlName="tenHSDoan"
                                    [attr.disabled]="true">
                            </td>
                            <td *ngIf="itemDP.value.type == '0'"><input type="text" class="form-control" name="ngayNC"
                                    formControlName="ngayXC" [attr.disabled]="true"></td>
                            <td *ngIf="itemDP.value.type == '0'"><input type="text" class="form-control" name="ngayXC"
                                    formControlName="ngayNC" [attr.disabled]="true"></td>
                            <td *ngIf="itemDP.value.type == '0'"><input type="text" class="form-control"
                                    name="noiLuuTru" formControlName="noiLuuTru" [attr.disabled]="true">

                            <td *ngIf="itemDP.value.type == '1'"><input class="form-control" type="text"
                                    placeholder="dd/mm/yyyy" bsDatepicker
                                    [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="ngayXC"
                                    formControlName="ngayXC" id="ngayXC{{i}}"
                                    (bsValueChange)="isInvalidDateNgayXCList($event,i)"
                                    (change)="checkDateNgayXCList($event,i)"
                                    (keypress)=" numberOnlywithForwardSlash($event)" maxlength="10" /></td>
                            <td *ngIf="itemDP.value.type == '1'"><input class="form-control" type="text"
                                    placeholder="dd/mm/yyyy" bsDatepicker
                                    [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY',showWeekNumbers: false }" name="ngayXC"
                                    formControlName="ngayNC" id="ngayNC{{i}}"
                                    (bsValueChange)="isInvalidDateNgayNCList($event,i)"
                                    (change)="checkDateNgayNCList($event,i)"
                                    (keypress)=" numberOnlywithForwardSlash($event)" maxlength="10" /></td>
                            <td *ngIf="itemDP.value.type == '1'"><input type="text" class="form-control"
                                    name="noiLuuTru" formControlName="noiLuuTru"></td>
                            <td class="text-center"><a class="delete" title="Delete" (click)="deleteRowTV(i)"
                                    data-toggle="tooltip"><i class="material-icons">&#xE872;</i></a></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br>
    </form>
    <div>
        <form name="createForm" (ngSubmit)="createDV()" action="" style="background-color: white;"
            [formGroup]="createForm">
            <div class="d-flex justify-content-end me-3 ms-3">
                <button class="btn btn-primary jh-create-entity buttonborder" data-cy="submit"
                    style="margin-right: 1%; width: 100px;" [disabled]="countThem == 0 && countXoa == 0">
                    <fa-icon class="bi bi-floppy-fill iconColor"></fa-icon>
                    <span class="iconColor">Lưu</span>
                </button>

                <button class="btn btn-primary jh-create-entity buttonborder" style="margin-right: 1%;"
                    routerLink="/doanRa/quanLyTVRa">
                    <fa-icon class="bi bi-box-arrow-left iconColor"></fa-icon>
                    <span class="iconColor">Quay lại</span>
                </button>
            </div>
            <br>
        </form>
    </div>
</div>

<app-alert></app-alert>